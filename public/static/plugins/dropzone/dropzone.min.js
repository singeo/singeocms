/** html
<div class="dropzone">
    <label>
    <span></span>
    <input type="file" name="imgFile" multiple/>
</label>
</div>
 **/

$(function () {
    $(".dropzone").change(function() {
        //获取图片信息
        var fileLise = $('input[type="file"]',this)[0].files;
        var fileLength = fileLise.length;
        //然后循环 生成html 插入页面上 最后就赋值给img
        for (var i = 0; i < fileLength; i++) {
            if (fileLise && fileLise[i]) {
                var file = new FileReader();
                file.readAsDataURL(fileLise[i]);
                file.onload = function() {
                    var imgsrc = this.result ;
                    var imgDiv = '<div class="imgDiv clearfix"><img src="' + imgsrc + '"><span><i class="imgRem">×</i></span>';
                    imgDiv += '<div class="imgBar clearfix"><span class="prevTxt">前移</span><span class="nextTxt">后移</span></div>' ;
                    imgDiv += '</div>' ;
                    $(".dropzone").prepend(imgDiv);
                }
            }
        }
    });
    $(".dropzone").on("click", ".imgRem", function() {
        $(this).parents(".imgDiv").remove();
    });
    $('.dropzone').on('click','.prevTxt',function () {
        var theNode = $(this).parents('.imgDiv') ;
        var theHtml = theNode.prop('outerHTML') ;
        var prevNode = theNode.prev('.imgDiv') ;
        if(prevNode.length > 0){
            prevNode.before(theHtml) ;
            theNode.remove() ;
        }
    }) ;
    $('.dropzone').on('click','.nextTxt',function () {
        var theNode = $(this).parents('.imgDiv') ;
        var theHtml = theNode.prop('outerHTML') ;
        var nextNode = theNode.next('.imgDiv') ;
        if(nextNode.length > 0){
            nextNode.after(theHtml) ;
            theNode.remove() ;
        }
    }) ;
}) ;